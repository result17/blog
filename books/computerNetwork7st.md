## 每一个IP地址都由网络号和主机号两部分组成
分配IP地址时只分配网络号，而剩下的主机号则由得到此网络号的单位自行分配。路由器仅根据目的主机所连接的网络号来转发分组。

## IP地址是标志一台主机和一条链路的接口
当一台主机同时连接到两个网络上时。该主机就必须同时具有两个相同的IP地址，其网络号必须是不同的。

## 在互联网上，一个网络是指具有相同网络号net-id的主机集合
因此用转发器或网桥连接起来的若干个局域网还是被视为同一个网络。

## 所有分配到网络号的网络都为平等
平等是指互联网同等对待每一个IP地址。

## 物理地址和IP地址
物理地址是数据链路层和物理层用的地址，而IP地址是网络层和以上各层使用的地址，是一个逻辑地址。

## ARP地址解析协议
在主机ARP高速缓存中存放一个从IP地址到硬件地址的映射表。如果不使用ARP高速滑轮，那么任何一台主机只要进行一次通信，就必须在网络上用广播方式发送ARP请求分组，这就使网络上的通信量大大增加。

## IPv4数据报首部字段
首部的前一部分是固定长度，共20字节，是所有数据报必须具有，后面是一些可选字段。
- IP协议版本。通信双方使用的IP协议的版本必须一致，占4位。
- 首部长度。占4位，每一单位表示32位字，最小长度为20字节（就是长度为5），最大长度为60字节（也即是不能超过12个长度）。当IP首部长度不是4个字节的整数倍，加以填充。
- 区分服务，没啥作用。
- 总长度。总长度指的是首部和数据之和的长度，单位为字节。总长度字段为16位。因此数据报的最大长度位2**16 - 1 = 65535字节。
在IP层下面的链路层都规定了一个数据帧中的数据字段的最大长度。这称为最大传送单元MTU。但IP数据报超过MTU值时，必须把过长的数据报进行分片处理
- 标识，占16位。IP地址在存储器中维持一个计算器，没产生一个数据报，计算器就加1。并将此值赋给标识字段。
- 标志，占3位，但目前只有两位有意义。标志中最低位为MF。当MF为1时，表示还有分配。当MF为0时，表示是分片最后一个。中间位为DF，意思是不能切片。
- 片偏移，占13位。片偏移指出：较长的分组在分片后，某片在原分组中的相对位置，也就是说，相对于用户数据字段的起点，该片从何处开始。片偏移以8个字节为偏移单位。也就是说，每个分片的长度一定是8字节的整数倍。
- TTL，生存时间，占8位。表明数据报在网络中的寿命，目的是防止数据报无限制地在互联网上兜圈子。早期TTL，是根据在路由器消耗的秒数进行相减，后来由于技术进步，转为跳数相减。当TTL值变为0时，丢弃此数据报。
- 协议，占8位。协议字段指出此数据报携带的数据是使用何种协议。
- 首部检验和，占16位。这个字段之检验数据报的首部，不包括数据部分。这是因为数据报每经过一个里尤其，路由器都要重新计算一下首部检验和。当首部未发生任何变化，则此结果必为0，就保留这个数据报，否则出差错，就将此数据报丢弃。
- 源地址 占32位
- 目的地址 占32位
## IP数据报首部可变部分
很多路由器不处理，默认没用，所以IPV6数据报首部做成固定长度。
## IPv6
- 更大的地址空间。IPv6把地址从IPv4的32位增大到4倍，即增大到128位，使地址空间增大了128倍/
- 扩展的地址层次结构。
- 灵活的首部格式。IPv6数据报首部和IPv4首部不兼容。IPv6定义了许多可选的扩展首部，不仅可提供比IPv4更多的功能，而且还可提供路由器的处理效率，这是因为路由器对扩展首部不进行处理。
- 改进的选项。IPv6允许数据报包含有选项的控制信息，因而可以包含一些新的选项，但IPv6的首部长度是固定的，其选项放在有效载荷中。
- 允许协议继续扩充。
- 支持即插即用。因此IPv6不需要DHCP。
- 支持资源的预分配。IPv6支持实时视像等要求保证一定的带宽和时延的应用。
- IPv6首部改为8字节对齐。
IP数据报由两大部分组成。即基本首部和后面的有效载荷。有效载荷允许由零个或多个扩展首部。但请注意，所有扩展首部并不属于IPv6数据报的首部。

## IPv6数据报首部字段
 IPv6首部长度固定为40字节。
- 版本，占4位。
- 通信量类，占8位。为了区分不同的IPv6数据报的类别或优先端。
- 流标号，占20位。IPv6的一个新的机制是支持资源预分配，并且允许路由器把每一个数据报与一个给定的资源分配相联系。IPv6提出流flow的抽象概念。所谓流就是互联网络上从特定源点到特定原点的一系列数据报。所有属于同一个流的数据报都具有同样的流标号。
- 有效载荷长度，占16位。除了IPv6数据报除基本首部以外的字节数。最大值为64kb。
- 下一个首部，占8位。
- 跳数限制，占8位。TTL。
- 源地址，占128位。
- 目的地址，占128位。

